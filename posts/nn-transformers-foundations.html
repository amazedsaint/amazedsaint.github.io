<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Neural Networks & Transformers: A Visual Introduction</title>
  <meta name="description" content="First‑principles, interactive visuals for the core ideas behind neural networks and transformers: linear units, nonlinearity, loss & gradient descent, softmax & cross‑entropy, dot‑product attention, positional encodings, layer norm & residuals, and receptive fields." />
  <link rel="stylesheet" href="../style.css" />
  <script>
    window.MathJax = {
      tex: { inlineMath: [["$","$"],["\\(","\\)"]], displayMath: [["$$","$$"],["\\[","\\]"]], packages: {'[+]':['base','ams']}, processEscapes: true },
      options: { skipHtmlTags: ['script','noscript','style','textarea','pre'] }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <script defer src="../js/notes.js"></script>
  <script defer src="../js/connections.js"></script>
  <script defer src="../js/nn-transformers.js"></script>
  <style>
    .section { margin: 28px 0 36px 0; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
    .demo { background:#fff; border:1px solid var(--border); border-radius:10px; padding:14px; max-width:880px; margin:12px auto; }
    canvas { display:block; margin:10px auto; border:1px solid var(--border); border-radius:8px; background:#fff; }
    .controls { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:8px; }
    .controls input[type=range], .controls select { accent-color: var(--accent); }
    .controls input[type=text] { padding:6px 8px; border:1px solid var(--border); border-radius:6px; font-size:14px; }
    .note { max-width:880px; margin:8px auto 0 auto; color: var(--muted); font-size:0.95em; }
    .bar { height:10px; background:#e8ecef; border-radius:6px; overflow:hidden; position:relative; }
    .bar > span { position:absolute; left:0; top:0; bottom:0; background:#1a8917; }
    .tokens { max-width:880px; margin:8px auto; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace; font-size:13px; }
    .token { display:inline-block; padding:4px 6px; border:1px solid var(--border); border-radius:6px; margin:2px; background:#fafafa; }
    .pair { display:inline-block; padding:2px 6px; border:1px solid var(--border); border-radius:6px; margin:2px; background:#fff; }
    .headgrid { display:grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap:10px; max-width:880px; margin: 8px auto; }
    .headbox { border:1px solid var(--border); border-radius:8px; padding:8px; background:#fff; text-align:center; }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1 class="site-title"><a href="../index.html">antifold</a></h1>
      <nav class="nav">
        <a href="../index.html">Home</a>
        <a href="https://github.com/amazedsaint">GitHub</a>
        <a href="https://twitter.com/amazedsaint">Twitter</a>
      </nav>
    </header>

    <article class="article-content">
      <div class="article-header">
        <span class="tile-category">AI</span>
        <h1 class="article-title">Neural Networks & Transformers: A Visual Introduction</h1>
        <div class="article-meta">September 24, 2025 • AI • Interactive</div>
        <p class="article-description">The core building blocks: linear units, nonlinearity, loss & gradient descent, softmax & cross‑entropy, dot‑product attention, positional encodings, layer norm & residuals, and receptive fields. Each section has an explainer, a formula, and a small visual.</p>
        <p class="note">Hover <span class="idea" data-note="Toolkit: dot product, linear maps, rotations. Primer: small oscillations intuition carries over to optimization landscapes.">here</span> for how this connects to earlier pieces.</p>
      </div>

      <div class="connections">
        <div class="header"><span class="title">Connections</span><span aria-hidden="true">▸</span></div>
        <div class="content">
          <ul>
            <li>Dot product & linear maps → <a href="physics-toolkit-intuition.html#vectors-and-dot-product">Toolkit</a>.</li>
            <li>Optimization landscape intuition → <a href="physics-math-primer.html#potentials-and-small-oscillations">Primer: Potentials</a>.</li>
            <li>Attention weights use softmax and dot products → see below; also <a href="physics-toolkit-intuition.html#fourier-builder">Toolkit: Fourier</a> for oscillatory ideas.</li>
          </ul>
        </div>
      </div>

      <div class="section">
        <h2 id="linear-units">Linear Units & Nonlinearity</h2>
        <p class="note">A single neuron computes a weighted sum and passes it through a nonlinearity: $$y = \phi(\mathbf w\cdot\mathbf x + b).$$ Without $\phi$, stacks of linear layers collapse to one linear map. With $\phi$ (ReLU, GELU, tanh), you can fit bends in the data.</p>
        <div class="demo">
          <canvas id="linUnit" width="520" height="320"></canvas>
          <div class="controls">
            <label>w0 <input id="w0" type="range" min="-2" max="2" step="0.01" value="1.0"/></label>
            <label>w1 <input id="w1" type="range" min="-2" max="2" step="0.01" value="-1.0"/></label>
            <label>b <input id="b" type="range" min="-1" max="1" step="0.01" value="0.0"/></label>
          </div>
          <p class="note">Decision line: <span id="linEq">…</span>.</p>
        </div>
      </div>

      <div class="section">
        <h2 id="softmax-crossentropy">Softmax & Cross‑Entropy</h2>
        <p class="note">Softmax turns logits into probabilities: $$p_i=\frac{e^{z_i}}{\sum_j e^{z_j}}.$$ For a target class $t$, cross‑entropy is $L=-\log p_t$.</p>
        <div class="demo">
          <div class="controls">
            <label>logit[0] <input id="l0" type="range" min="-3" max="3" step="0.01" value="0.5"/></label>
            <label>logit[1] <input id="l1" type="range" min="-3" max="3" step="0.01" value="-0.2"/></label>
            <label>logit[2] <input id="l2" type="range" min="-3" max="3" step="0.01" value="1.0"/></label>
            <label>target <select id="tgt"><option value="0">0</option><option value="1">1</option><option value="2" selected>2</option></select></label>
          </div>
          <div class="note">probabilities</div>
          <div class="bar"><span data-soft></span></div>
          <div class="bar"><span data-soft></span></div>
          <div class="bar"><span data-soft></span></div>
          <div class="note">values: <span class="value">…</span>, <span class="value">…</span>, <span class="value">…</span> • Cross‑entropy: <strong id="xent">…</strong></div>
        </div>
      </div>

      <div class="section">
        <h2 id="attention">Dot‑Product Attention</h2>
        <p class="note">Weights for one query $q_i$ over keys $K$: softmax of scaled dot products.</p>
        <div class="demo">
          <canvas id="attn" width="520" height="220"></canvas>
          <div class="controls">
            <label>query index <input id="qpick" type="range" min="0" max="4" step="1" value="2"/></label>
            <label>temperature <input id="temp" type="range" min="0.2" max="3.0" step="0.01" value="1.0"/></label>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 id="positional-encodings">Positional Encodings</h2>
        <p class="note">Sinusoidal bands encode position at multiple scales.</p>
        <div class="demo">
          <canvas id="posenc" width="520" height="160"></canvas>
          <div class="controls">
            <label>length <input id="L" type="range" min="8" max="128" step="1" value="32"/></label>
            <label>channels <input id="D" type="range" min="4" max="64" step="1" value="8"/></label>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 id="layernorm-residuals">Layer Norm & Residuals</h2>
        <div class="demo">
          <canvas id="ln" width="520" height="150"></canvas>
        </div>
      </div>

      <div class="section">
        <h2 id="receptive-fields">Receptive Fields</h2>
        <div class="demo">
          <canvas id="rf" width="520" height="140"></canvas>
          <div class="controls">
            <label>mode <select id="mode"><option value="attn" selected>attention</option><option value="conv">convolution</option></select></label>
            <label>kernel <input id="kern" type="range" min="1" max="9" step="2" value="3"/></label>
            <label>center <input id="center" type="range" min="0" max="11" step="1" value="6"/></label>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 id="gradient-descent">Gradient Descent (2D Bowl)</h2>
        <div class="demo">
          <canvas id="gd" width="520" height="320"></canvas>
          <div class="controls">
            <label>learning rate η <input id="gdLR" type="range" min="0.02" max="0.6" step="0.01" value="0.20"/></label>
            <button id="gdStep">Step</button>
            <button id="gdRun">Run</button>
            <button id="gdReset">Reset</button>
          </div>
          <p class="note"><span id="gdxy">…</span></p>
        </div>
      </div>

      <div class="section">
        <h2 id="tiny-mlp">A Tiny MLP (Two ReLUs)</h2>
        <div class="demo">
          <canvas id="mlp" width="520" height="220"></canvas>
          <div class="controls">
            <label>w1a <input id="w1a" type="range" min="-5" max="5" step="0.05" value="3.0"/></label>
            <label>b1a <input id="b1a" type="range" min="-2" max="2" step="0.01" value="0.0"/></label>
            <label>v1a <input id="v1a" type="range" min="-3" max="3" step="0.05" value="1.0"/></label>
            <label>w1b <input id="w1b" type="range" min="-5" max="5" step="0.05" value="-2.0"/></label>
            <label>b1b <input id="b1b" type="range" min="-2" max="2" step="0.01" value="0.5"/></label>
            <label>v1b <input id="v1b" type="range" min="-3" max="3" step="0.05" value="1.0"/></label>
            <label>b2 <input id="b2" type="range" min="-1" max="1" step="0.01" value="0.0"/></label>
          </div>
          <p class="note">Equation: <span id="mlpeq">…</span></p>
          <div class="controls">
            <label>x₀ (for backprop) <input id="x0" type="range" min="-1" max="1" step="0.01" value="0.0"/></label>
          </div>
          <p class="note">Gradients at x₀: <span id="grads">…</span></p>
        </div>
      </div>

      <div class="section">
        <h2 id="toy-bpe">A Toy Tokenizer (BPE)</h2>
        <div class="demo" id="bpeArea">
          <div class="controls">
            <label>Input text <input id="bpeInput" type="text" value="the other brother"/></label>
            <button id="bpeStep">Step merge</button>
            <button id="bpeReset">Reset</button>
          </div>
          <div class="note">Tokens</div>
          <div class="tokens" id="bpeTokens"></div>
          <div class="note">Top pairs</div>
          <div class="tokens" id="bpePairs"></div>
          <div class="note">Merges so far: <span id="bpeMerges">…</span></div>
        </div>
      </div>

      <div class="section">
        <h2 id="attention-aggregation">Attention: Values Aggregation</h2>
        <div class="demo">
          <canvas id="attnAgg" width="520" height="220"></canvas>
          <div class="controls">
            <label>query index <input id="aggQ" type="range" min="0" max="4" step="1" value="2"/></label>
            <label>temperature <input id="aggTemp" type="range" min="0.2" max="3.0" step="0.01" value="1.0"/></label>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 id="multi-head">Multi‑Head Attention (Weights)</h2>
        <div class="demo">
          <div class="controls">
            <label>heads <input id="mhaH" type="range" min="2" max="6" step="1" value="4"/></label>
            <label>query index <input id="mhaQ" type="range" min="0" max="5" step="1" value="3"/></label>
            <label>temperature <input id="mhaTemp" type="range" min="0.2" max="3.0" step="0.01" value="1.0"/></label>
          </div>
          <div id="mhaGrid" class="headgrid"></div>
        </div>
      </div>

      <div class="section">
        <h2 id="ffn-block">Position‑wise Feed‑Forward (FFN)</h2>
        <div class="demo">
          <canvas id="ffn" width="520" height="180"></canvas>
        </div>
      </div>

      <div class="section">
        <h2 id="putting-it-together">Putting It Together: A Transformer Block</h2>
        <div class="demo">
          <canvas id="tf" width="520" height="220"></canvas>
          <div class="controls">
            <button id="tfStep">Step</button>
            <button id="tfReset">Reset</button>
          </div>
        </div>
      </div>

      <div class="connections">
        <div class="header"><span class="title">Connections</span><span aria-hidden="true">▸</span></div>
        <div class="content">
          <ul>
            <li>Dot products & linear maps → <a href="physics-toolkit-intuition.html#vectors-and-dot-product">Toolkit</a>.</li>
            <li>Optimization intuition → <a href="physics-math-primer.html#potentials-and-small-oscillations">Primer</a>.</li>
            <li>Softmax appears in attention & classification.</li>
          </ul>
        </div>
      </div>

      <div class="related-links">
        <strong>Related:</strong>
        <a href="physics-toolkit-intuition.html">Toolkit</a> •
        <a href="physics-math-primer.html">Primer</a> •
        <a href="../index.html">Home</a>
      </div>
    </article>

    <footer class="footer">
      <p>&copy; 2025 antifold • Essays and simulations</p>
      <p class="meta-mini">By Anoop • <a href="https://twitter.com/amazedsaint">Twitter</a> • <a href="https://github.com/amazedsaint">GitHub</a> • <a href="../index.html">Home</a></p>
    </footer>
  </div>
</body>
</html>
